!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],e):"object"==typeof exports?exports.ContextMenuPlugin=e(require("Clappr")):t.ContextMenuPlugin=e(t.Clappr)}(window,(function(t){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="latest/",n(n.s=0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(1),i=c(n(2)),r=c(n(4));function c(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=s(this,l(e).call(this,t))).extraOptions=n.options.contextMenu&&n.options.contextMenu.extraOptions||[],n.delegateEvents(n.events),n.bindEvents(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,t),f(e,[{key:"name",get:function(){return"context_menu"}},{key:"attributes",get:function(){return{class:"context-menu"}}},{key:"template",get:function(){return(0,o.template)(r.default)}},{key:"loopEnable",get:function(){return this.core.activePlayback.el.loop}},{key:"playerVersion",get:function(){return{label:"Clappr Player v".concat(Clappr.version),name:"playerVersion"}}},{key:"copyURL",get:function(){return{label:"Copy URL",name:"copyURL"}}},{key:"copyURLCurrentTime",get:function(){return{label:"Copy URL on current time",name:"copyURLCurrentTime"}}},{key:"loop",get:function(){return{label:"Loop: ",name:"loop",class:this.core.options.loop?"on":"off"}}},{key:"events",get:function(){var t=this,e={"click [data-copyURL]":"onCopyURL","click [data-copyURLCurrentTime]":"onCopyURLCurrentTime","click [data-loop]":"onToggleLoop"};return this.extraOptions&&this.extraOptions.forEach((function(n){if("function"==typeof n.callback){var o="".concat(n.name,"Callback");t[o]=n.callback,e["click [data-".concat(n.name,"]")]=o}})),e}}]),f(e,[{key:"bindEvents",value:function(){var t=[{object:this.core,event:o.Events.CORE_ACTIVE_CONTAINER_CHANGED,callback:this.containerChanged}];this.stopListening(t[0].object,t[0].event,t[0].callback),this.listenTo(t[0].object,t[0].event,t[0].callback),this.bindCustomEvents()}},{key:"bindContainerEvents",value:function(){var t=this,e=[{object:this.container,event:o.Events.CONTAINER_CONTEXTMENU,callback:this.toggleContextMenu},{object:this.container,event:o.Events.CONTAINER_CLICK,callback:this.hide}];this.container&&(e.forEach((function(e){return t.stopListening(e.object,e.event,e.callback)})),e.forEach((function(e){return t.listenTo(e.object,e.event,e.callback)})))}},{key:"bindCustomEvents",value:function(){$("body").off("click",this.hide.bind(this)),$("body").on("click",this.hide.bind(this))}},{key:"destroy",value:function(){$("body").off("click",this.hide.bind(this)),this.stopListening(),u(l(e.prototype),"destroy",this).call(this)}},{key:"containerChanged",value:function(){this.container=this.core.activeContainer,this.bindContainerEvents()}},{key:"toggleContextMenu",value:function(t){t.preventDefault(),this.show(t.offsetY,t.offsetX)}},{key:"show",value:function(t,e){!this.playerElement&&this.calculateContextMenuLimit();var n=t>this.maxHeight?this.maxHeight:t,o=e>this.maxWidth?this.maxWidth:e;this.hide(),this.$el.css({top:n,left:o}),this.$el.show()}},{key:"calculateContextMenuLimit",value:function(){this.playerElement=document.querySelector("[data-player]"),this.maxWidth=this.playerElement.clientWidth-160,this.maxHeight=this.playerElement.clientHeight-200}},{key:"hide",value:function(){this.$el.hide()}},{key:"copyToClipboard",value:function(t,e){if(e){var n=$('<textarea class="copytextarea"/>');n.text(t),e.append(n[0]),document.querySelector(".context-menu .copytextarea").select();try{document.execCommand("copy")}catch(t){throw Error(t)}n.remove()}}},{key:"onCopyURL",value:function(){this.copyToClipboard(window.location.href,this.$el)}},{key:"onCopyURLCurrentTime",value:function(){var t=window.location.href,e=Math.floor(this.container.getCurrentTime());if(""===window.location.search)t+="?t=".concat(e);else if(-1===window.location.search.split(/[\?=&]/g).indexOf("t"))t+="&t=".concat(e);else if(-1!==window.location.search.split(/[\?=&]/g).indexOf("t")){var n=window.location.search.split(/[\?&]/g).find((function(t){return t.includes("t=")})),o=window.location.search.replace(n,"t=".concat(e));t="".concat(t.replace(window.location.search,"")).concat(o)}this.copyToClipboard(t,this.$el)}},{key:"onToggleLoop",value:function(){this.core.options.loop=!this.loopEnable,this.core.activePlayback.el.loop=!this.loopEnable,this.$el.find("[data-loop]").toggleClass("on",this.loopEnable),this.$el.find("[data-loop]").toggleClass("off",!this.loopEnable)}},{key:"appendExtraOptions",value:function(t){this.menuOptions.unshift(t)}},{key:"addCustomStyle",value:function(){var t=this.options.contextMenu&&this.options.contextMenu.customStyle;t&&(this.$el.css(t.container),this.$el.find(".context-menu-list").css(t.list),this.$el.find(".context-menu-list-item").css(t.items))}},{key:"sanitizeCustomizedItems",value:function(){var t=this,e=[];return this.options.contextMenu.menuItems.forEach((function(n){void 0!==t[n]&&e.push(t[n])})),e}},{key:"render",value:function(){var t=this;return this.customMenuItems=this.options.contextMenu&&this.options.contextMenu.menuItems&&this.sanitizeCustomizedItems(),this.menuOptions=this.customMenuItems&&this.customMenuItems.length>0?this.customMenuItems:[this.copyURL,this.copyURLCurrentTime,this.loop,this.playerVersion],this.options.contextMenu&&this.options.contextMenu.extraOptions&&this.options.contextMenu.extraOptions.forEach((function(e){return t.appendExtraOptions(e)})),this.$el.html(this.template({options:this.menuOptions})),this.$el.append(o.Styler.getStyleFor(i.default)),this.core.$el[0].append(this.$el[0]),this.hide(),this.disable(),this.addCustomStyle(),this}}]),e}(o.UICorePlugin);e.default=d,t.exports=e.default},function(e,n){e.exports=t},function(t,e,n){(e=n(3)(!1)).push([t.i,".context-menu{z-index:999;position:absolute;top:0;left:0;text-align:center}.context-menu .context-menu-list{font-family:\"Proxima Nova\";font-size:12px;line-height:12px;list-style-type:none;text-align:left;padding:5px;margin-left:auto;margin-right:auto;background-color:rgba(0,0,0,0.75);border:1px solid #666;border-radius:4px}.context-menu .context-menu-list .context-menu-list-item{color:white;padding:5px;cursor:pointer}.context-menu .context-menu-list .context-menu-list-item:hover{color:#2b669a}.context-menu .context-menu-list .context-menu-list-item[data-version]{pointer-events:none}.context-menu .context-menu-list .context-menu-list-item[data-loop].on:after{content:'ON'}.context-menu .context-menu-list .context-menu-list-item[data-loop].off:after{content:'OFF'}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa){var i=(c=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(c)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(s," */")),r=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[n].concat(r).concat([i]).join("\n")}var c,a,s;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(o)for(var r=0;r<this.length;r++){var c=this[r][0];null!=c&&(i[c]=!0)}for(var a=0;a<t.length;a++){var s=[].concat(t[a]);o&&i[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),e.push(s))}},e}},function(t,e){t.exports='<ul class="context-menu-list">\n  <% if(options) { %>\n    <% for (var i = 0; i < options.length; i++) { %>\n        <li class="context-menu-list-item <%=options[i].class%>" data-<%=options[i].name%>><%=options[i].label%></li>\n    <% } %>\n  <% } %>\n</ul>\n'}])}));